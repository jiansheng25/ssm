<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>æ ¡æ–¹ä¸»é¡µ</title>
    <script src="../js/mainJs.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/school/addStudent.css"/>
    <script src="../js/jquery-3.4.1.min.js" type="text/javascript"></script>
    <script src="../js/jquery.cookie.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            load1();
            tiaozhuan2();
            init()
        });
        function init() {
            $.ajax({
                type: "POST",                            //ä¼ æ•°æ®çš„æ–¹å¼
                url: commomPath + "getAllXueyuanServlet", //servletåœ°å€getEmploymentForComServlet
                data: {
                },
                success: function (data) { //ä¼ æ•°æ®æˆåŠŸä¹‹åçš„æ“ä½œ   resultæ˜¯servletä¼ è¿‡æ¥çš„æ•°æ®  è¿™ä¸ªå‡½æ•°å¯¹resultè¿›è¡Œå¤„ç†ï¼Œè®©å®ƒæ˜¾ç¤ºåœ¨ è¾“å…¥æ¡†ä¸­
                    var list = $.parseJSON(data);
                    $("#xueyuanListForstu").html("");

                    $("#xueyuanListForstu").append($("<option value=\"0\">ï¼è¯·é€‰æ‹©å­¦é™¢ï¼</option>"));
                    $("#classList").append($("<option value=\"0\">ï¼è¯·é€‰æ‹©ç­çº§ï¼</option>"));
                    $.each(list, function (i, n) {
                        $("#xueyuanListForstu").append($("<option value=\"" + n.xyId + "\">" + n.xyName + "</option>"));
                    });
                },
                error: function () {
                    alert("ä¿¡æ¯ä¼ è¾“é”™è¯¯ï¼");
                }
            })
            $.ajax({
                type: "POST",                            //ä¼ æ•°æ®çš„æ–¹å¼
                url: commomPath + "getStudentBystuIdServlet", //servletåœ°å€getEmploymentForComServlet
                data: {
                    stuId:$.cookie("stuAccount")
                },
                success: function (data) { //ä¼ æ•°æ®æˆåŠŸä¹‹åçš„æ“ä½œ   resultæ˜¯servletä¼ è¿‡æ¥çš„æ•°æ®  è¿™ä¸ªå‡½æ•°å¯¹resultè¿›è¡Œå¤„ç†ï¼Œè®©å®ƒæ˜¾ç¤ºåœ¨ è¾“å…¥æ¡†ä¸­

                    var list = $.parseJSON(data);
                    console.log(list)
                    $("#xueyuanListForstu").val(list[0].xyId);

                    // className:$("#classList").val(),
                    $("#stuName").val(list[0].stuName);
                    $("#stuAccount").val(list[0].stuAccount);
                    $("#genderList").val(list[0].gender);
                    $("#age").val(list[0].age);
                    $("#stuPwd").val(list[0].stuPwd);
                    getClassByXyId();
                    $("#classList").val(list[0].stuClass)
                },
                error: function () {
                    alert("ä¿¡æ¯ä¼ è¾“é”™è¯¯ï¼");
                }
            })
        }

        function getClassByXyId(){
            console.log($("#xueyuanListForstu").val())
            $.ajax({
                type: "POST",                            //ä¼ æ•°æ®çš„æ–¹å¼
                url: commomPath + "getClassByXyIdServlet", //servletåœ°å€getEmploymentForComServlet
                data: {
                    xyId:$("#xueyuanListForstu").val()
                },
                success: function (data) { //ä¼ æ•°æ®æˆåŠŸä¹‹åçš„æ“ä½œ   resultæ˜¯servletä¼ è¿‡æ¥çš„æ•°æ®  è¿™ä¸ªå‡½æ•°å¯¹resultè¿›è¡Œå¤„ç†ï¼Œè®©å®ƒæ˜¾ç¤ºåœ¨ è¾“å…¥æ¡†ä¸­
                    var list = $.parseJSON(data);
                    $("#classList").html("");

                    $.each(list, function (i, n) {
                        $("#classList").append($("<option value=\"" + n.className + "\">" + n.className + "</option>"));
                    });
                },
                error: function () {
                    alert("ä¿¡æ¯ä¼ è¾“é”™è¯¯ï¼");
                }
            })
        }

        function editStudentBtn() {
            console.log($("#age").val());
            console.log($("#classList").val());
            if($("#xueyuanListForstu").val()==0||$("#xueyuanListForstu").val()=="0"){
                alert("è¯·é€‰æ‹©å­¦é™¢");return;
            }
            if($("#classList").val()==0||$("#classList").val()=="0"){
                alert("è¯·é€‰æ‹©ç­çº§");return;
            }
            if($("#stuAccount").val()==""||$("#stuName").val()==""||
                $("#genderList").val()==""||$("#age").val()==""||$("#stuPwd").val()==""){
                alert("è¯·è¾“å…¥å®Œæ•´ä¿¡æ¯ï¼");return;
            }
            $.ajax({
                type: "POST",
                url: commomPath + "updateStudentForScServlet", //servletåœ°å€
                data: {
                    className:$("#classList").val(),
                    stuName:$("#stuName").val(),
                    stuAccount:$("#stuAccount").val(),
                    gender:$("#genderList").val(),
                    age:$("#age").val(),
                    stuPwd:$("#stuPwd").val(),
                    stuId:$.cookie("stuAccount")
                },
                success: function (data) { //ä¼ æ•°æ®æˆåŠŸä¹‹åçš„æ“ä½œ   resultæ˜¯servletä¼ è¿‡æ¥çš„æ•°æ®  è¿™ä¸ªå‡½æ•°å¯¹resultè¿›è¡Œå¤„ç†ï¼Œè®©å®ƒæ˜¾ç¤ºåœ¨ è¾“å…¥æ¡†ä¸­
                    if (data == "1") {
                        alert("ä¿®æ”¹æˆåŠŸï¼");
                    } else {alert("ä¿®æ”¹å¤±è´¥ï¼");}
                },
                error: function () {
                    alert("ä¿¡æ¯ä¼ è¾“é”™è¯¯ï¼");
                }
            })
        }

        function getClassByXyId(){
            console.log($("#xueyuanListForstu").val())
            $.ajax({
                type: "POST",                            //ä¼ æ•°æ®çš„æ–¹å¼
                url: commomPath + "getClassByXyIdServlet", //servletåœ°å€getEmploymentForComServlet
                data: {
                    xyId:$("#xueyuanListForstu").val()
                },
                success: function (data) { //ä¼ æ•°æ®æˆåŠŸä¹‹åçš„æ“ä½œ   resultæ˜¯servletä¼ è¿‡æ¥çš„æ•°æ®  è¿™ä¸ªå‡½æ•°å¯¹resultè¿›è¡Œå¤„ç†ï¼Œè®©å®ƒæ˜¾ç¤ºåœ¨ è¾“å…¥æ¡†ä¸­
                    var list = $.parseJSON(data);
                    $("#classList").html("");

                    $.each(list, function (i, n) {
                        $("#classList").append($("<option value=\"" + n.className + "\">" + n.className + "</option>"));
                    });
                },
                error: function () {
                    alert("ä¿¡æ¯ä¼ è¾“é”™è¯¯ï¼");
                }
            })
        }



    </script>
</head>
<body>
<form>
    <div id="main">
        <div class="top">
            <div class="top1">
                <img src="../img/5454545.PNG" height="50px" width="50px" onclick="tiaozhuan()" >
            </div>
            <div class="top2">
                æ±Ÿæµ·å¤§æ ¡å›­æ‹›è˜å¹³å°å­¦æ ¡ç«¯
            </div>
            <div class="top33">
                <div class="top44">

                </div>
                <div class="top45">
                    <div class="top3">
                        <img class="tu" src="../img/111111.png" id="ddd" >
                    </div>
                    <div class="top4">
                        <a href="schoollogin.html" style="color:#bcbdcf ;font-size: 11px;">é€€å‡º</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="btttom">
            <div class="left">
                <div class="left3"></div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" id="postXuan" type="button" name="" value="å‘å¸ƒå®£è®²ä¼š" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" id="xuanjianManager" type="button" name="" value="å®£è®²ä¼šç®¡ç†" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" id="postZhan" type="button" name="" value="æ‹›è˜ä¼š" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" type="button" name="" id="postion" value="å‘å¸ƒèŒä½" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" type="button" name="" id="applyManager" value="æ‹›è˜ç®¡ç†" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" type="button" name="" id="recriutManager" value="èŒä½ç®¡ç†" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" id="companyManager" type="button" name="" value="ä¼ä¸šç®¡ç†" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" type="button" name="" id="studentManager" value="å­¦ç”Ÿç®¡ç†" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" type="button" name="" id="addStudent" value="å­¦ç”Ÿå½•å…¥" />
                    </div>
                </div>
                <div class="left1">
                    <div class="left11">
                        ğŸ
                    </div>
                    <div class="left12">
                        <input class="btn1" type="button" name="" id="passwordManager" value="å¯†ç ç®¡ç†" />
                    </div>
                </div>
            </div>
            <div class="right">
                <div class="rtop">
                    <div class="rtopb">
                        <div class="choose">
                            <div class="choose-stu" style="text-align: left;font-weight: 700">
                                ä¿®æ”¹å­¦ç”Ÿä¿¡æ¯
                            </div>

                        </div>
                        <div class="add_student">
                            <div class="add_xueyuan_item"></div>
                            <div class="add_xueyuan_item">
                                <select id="xueyuanListForstu" onchange="getClassByXyId()"></select>
                            </div>
                            <div class="add_xueyuan_item">
                                <select id="classList"></select>
                            </div>
                            <div class="add_xueyuan_item"><input class="item_text" type="text" id="stuName" placeholder="è¯·è¾“å…¥å§“å"></div>
                            <div class="add_xueyuan_item"><input class="item_text" type="text" id="stuAccount" placeholder="è¯·è¾“å…¥å­¦å·"></div>
                            <div class="add_xueyuan_item"><input class="item_text" type="text" id="stuPwd" placeholder="è®¾ç½®å­¦ç”Ÿç™»é™†å¯†ç "></div>
                            <div class="add_xueyuan_item">
                                <select id="genderList">
                                    <option value="ç”·">ç”·</option>
                                    <option value="å¥³">å¥³</option>
                                </select>
                            </div>
                            <div class="add_xueyuan_item">å‡ºç”Ÿæ—¥æœŸï¼š
                                <input class="item_text" id="age" style="width: 220px" type="date" placeholder="è¯·é€‰æ‹©å­¦ç”Ÿç”Ÿæ—¥">
                            </div>
                            <div class="add_xueyuan_item"><input class="item_btn" type="button" onclick="editStudentBtn()" value="ç¡®è®¤ä¿®æ”¹"></div>
                        </div>
                    </div>
                </div>
                <div class="rbton">
                    ç‰ˆæƒæ‰€æœ‰ï¼šä¸ªäººæ¯•ä¸šè®¾è®¡
                </div>
            </div>
        </div>
    </div>
</form>
</body>
</html>
<script type="text/javascript">
    function tiaozhuan() {
        window.location.href = "comlogin.html";
    };

    function tiaozhuan2() {
        $("#postZhan").click(function () {
            window.location.href = "postZhanpinhui.html";
        })
        $("#postXuan").click(function () {
            window.location.href = "main.html";
        })
        $("#companyManager").click(function () {
            window.location.href = "companyManager.html";
        })
        $("#studentManager").click(function () {
            window.location.href = "studentManager.html";
        })
        $("#recriutManager").click(function () {
            window.location.href = "recriutManager.html";
        })
        $("#passwordManager").click(function () {
            window.location.href = "passwordManager.html";
        })
        $("#addStudent").click(function () {
            window.location.href = "addStudent.html";
        })
        $("#postion").click(function () {
            window.location.href = "postion.html";
        })
        $("#applyManager").click(function () {
            window.location.href = "applyManager.html";
        })
        $("#xuanjianManager").click(function () {
            window.location.href = "xuanjianManager.html";
        })
    }

    function load1() {//è·å–å½“å‰ç®¡ç†å‘˜
        $.ajax({
            type: "POST",                            //ä¼ æ•°æ®çš„æ–¹å¼
            url: commomPath + "sc/scInfo", //servletåœ°å€
            data: {},
            datatype: "json",
            success: function (data) { //ä¼ æ•°æ®æˆåŠŸä¹‹åçš„æ“ä½œ   resultæ˜¯servletä¼ è¿‡æ¥çš„æ•°æ®  è¿™ä¸ªå‡½æ•°å¯¹resultè¿›è¡Œå¤„ç†ï¼Œè®©å®ƒæ˜¾ç¤ºåœ¨ è¾“å…¥æ¡†ä¸­
                var schoolJson = $.parseJSON(data);
                $(".top44").text(schoolJson.name);
            },
            error: function () {
                alert("ä¿¡æ¯ä¼ è¾“å‘ç”Ÿé”™è¯¯ï¼");
            }
        })
    }
</script>